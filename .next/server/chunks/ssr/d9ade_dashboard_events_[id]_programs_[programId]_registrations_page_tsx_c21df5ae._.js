module.exports=[23728,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(15618),f=a.i(87532),g=a.i(81560),h=a.i(46864),i=a.i(60246),j=a.i(83077),k=a.i(21374),l=a.i(13749),m=a.i(50522),n=a.i(43108),o=a.i(16201);let p=(0,a.i(70106).default)("ban",[["path",{d:"M4.929 4.929 19.07 19.071",key:"196cmz"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);var q=a.i(24569),r=a.i(53250),s=a.i(38246),t=a.i(67335),u=a.i(78211);function v(){let{id:a,programId:v}=(0,d.useParams)(),[w,x]=(0,c.useState)([]),[y,z]=(0,c.useState)(!0),[A,B]=(0,c.useState)(""),[C,D]=(0,c.useState)(null),[E,F]=(0,c.useState)(1),[G,H]=(0,c.useState)(!1),[I,J]=(0,c.useState)(null),[K,L]=(0,c.useState)(!1),[M,N]=(0,c.useState)(!1),[O,P]=(0,c.useState)(!1),[Q,R]=(0,c.useState)(null),[S,T]=(0,c.useState)(""),[U,V]=(0,c.useState)(""),[W,X]=(0,c.useState)(!1),[Y,Z]=(0,c.useState)([]),[$,_]=(0,c.useState)(""),[aa,ab]=(0,c.useState)([]),[ac,ad]=(0,c.useState)([]),[ae,af]=(0,c.useState)(""),[ag,ah]=(0,c.useState)(!1);(0,c.useEffect)(()=>{v&&(ak(E),ai())},[v,E]),(0,c.useEffect)(()=>{let a=setTimeout(()=>{ae.length>=2||0===ae.length&&$?aj():!$&&ae.length<2&&ab([])},500);return()=>clearTimeout(a)},[ae,$]);let ai=async()=>{try{let a=await r.default.get("/colleges");a.data.success&&Z(a.data.data)}catch(a){(0,u.showError)(a)}},aj=async()=>{if(!$&&!ae)return void ab([]);ah(!0);try{let a=await r.default.get("/students",{params:{college:$,search:ae}});a.data.success&&ab(a.data.data)}catch(a){(0,u.showError)(a)}finally{ah(!1)}},ak=async(a=1)=>{try{z(!0);let b=await r.default.get(`/registrations/program/${v}?page=${a}&limit=50`);b.data.success&&(x(b.data.registrations||[]),D(b.data.pagination||null),H(b.data.isResultPublished||!1),J(b.data.program||null))}catch(a){(0,u.showError)(a)}finally{z(!1)}},al=async()=>{if(0!==ac.length)try{Q?(await r.default.put(`/registrations/${Q._id}`,{participants:ac})).data.success&&((0,u.showSuccess)("Registration updated successfully"),am(),ak()):(await r.default.post("/registrations",{program:v,participants:ac})).data.success&&((0,u.showSuccess)("Registration successful"),am(),ak())}catch(a){(0,u.showError)(a)}},am=()=>{L(!1),R(null),ad([]),_(""),af("")},an=async a=>{if(confirm("Are you sure you want to delete this registration?"))try{(await r.default.delete(`/registrations/${a}`)).data.success&&((0,u.showSuccess)("Registration deleted successfully"),ak())}catch(a){(0,u.showError)(a)}},ao=async(a,b)=>{try{(await r.default.patch(`/registrations/${a}/status`,{status:b})).data.success&&((0,u.showSuccess)(`Status updated to ${b}`),ak())}catch(a){(0,u.showError)(a)}},ap=async a=>{if(a.preventDefault(),Q&&U)try{(await r.default.post(`/registrations/${Q._id}/cancel`,{reason:U})).data.success&&((0,u.showSuccess)("Registration cancelled"),P(!1),V(""),R(null),ak())}catch(a){(0,u.showError)(a)}},aq=async a=>{if(a.preventDefault(),Q&&S){X(!0);try{(await r.default.post("/scores/submit",{programId:v,registrationId:Q._id,criteria:{Mark:parseFloat(S)}})).data.success&&((0,u.showSuccess)("Score submitted successfully"),N(!1),T(""),R(null),ak())}catch(a){(0,u.showError)(a)}finally{X(!1)}}},ar=w.filter(a=>a.chestNumber.toLowerCase().includes(A.toLowerCase())||a.participants.some(a=>a.registrationCode.toLowerCase().includes(A.toLowerCase())||a.name?.toLowerCase().includes(A.toLowerCase())));return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,b.jsx)(s.default,{href:"/dashboard/events",className:"hover:text-primary",children:"Events"}),(0,b.jsx)("span",{children:"/"}),(0,b.jsx)(s.default,{href:`/dashboard/events/${a}/programs`,className:"hover:text-primary",children:"Programs"}),(0,b.jsx)("span",{children:"/"}),(0,b.jsx)("span",{className:"text-foreground font-medium",children:"Registrations"})]}),(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"Registrations"}),I&&(0,b.jsxs)("p",{className:"text-sm text-muted-foreground mt-1 flex items-center gap-2 font-sans",children:["Program: ",(0,b.jsx)("span",{className:"text-primary font-bold px-2 py-0.5 bg-primary/10 rounded",children:I.name})]})]}),(0,b.jsxs)("button",{disabled:G,title:G?"Registration Closed (Published)":"New Registration",onClick:()=>L(!0),className:"flex items-center gap-2 bg-primary hover:bg-primary/90 text-primary-foreground px-4 py-2 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[G?(0,b.jsx)(n.Lock,{className:"h-4 w-4"}):(0,b.jsx)(e.Plus,{className:"h-4 w-4"}),"New Registration"]})]}),K&&(0,b.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4 font-sans text-foreground",children:(0,b.jsxs)("div",{className:"bg-card border border-border rounded-xl w-full max-w-md p-6 shadow-2xl flex flex-col max-h-[90vh]",children:[(0,b.jsx)("h2",{className:"text-xl font-bold mb-4",children:Q?"Edit Registration":"Register for Program"}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("label",{className:"text-xs text-muted-foreground block mb-2",children:"Selected Participants"}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-2 min-h-[40px] p-2 bg-secondary rounded-lg border border-border",children:[0===ac.length&&(0,b.jsx)("span",{className:"text-xs text-muted-foreground italic",children:"No students selected"}),ac.map(a=>{let c=aa.find(b=>b._id===a)||w.flatMap(a=>a.participants).find(b=>b._id===a);return(0,b.jsxs)("span",{className:"bg-primary/20 text-primary px-2 py-1 rounded-md text-xs flex items-center gap-1",children:[c?.name||c?.registrationCode,(0,b.jsx)("button",{onClick:()=>ad(ac.filter(b=>b!==a)),className:"hover:text-foreground",children:"×"})]},a)})]})]}),(0,b.jsxs)("div",{className:"space-y-4 flex-1 overflow-hidden flex flex-col",children:[(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(t.default,{label:"Filter by College",options:Y,value:$,onChange:a=>{ac.length>0||_(a)},placeholder:"Select College...",disabled:ac.length>0}),ac.length>0&&(0,b.jsxs)("p",{className:"text-[10px] text-primary mt-1 flex items-center gap-1 font-bold",children:[(0,b.jsx)(n.Lock,{className:"h-3 w-3"})," College locked (Group members must be from same college)"]})]}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(f.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,b.jsx)("input",{className:"w-full bg-secondary border border-border rounded-lg pl-9 pr-3 py-2 text-sm outline-none focus:border-primary",placeholder:"Search by Name or Reg No...",value:ae,onChange:a=>af(a.target.value)})]}),(0,b.jsx)("div",{className:"flex-1 overflow-y-auto border border-border rounded-lg divide-y divide-border min-h-[200px]",children:ag?(0,b.jsx)("p",{className:"p-4 text-center text-xs text-muted-foreground",children:"Searching..."}):0===aa.length?(0,b.jsx)("p",{className:"p-4 text-center text-xs text-muted-foreground italic truncate",children:$?"No students found":"Select a college first"}):aa.filter(a=>!ac.includes(a._id)).filter(a=>{if(0===ac.length)return!0;let b=w.flatMap(a=>a.participants).find(a=>a._id===ac[0])||aa.find(a=>a._id===ac[0]);return a.college._id===b?.college._id}).map(a=>(0,b.jsxs)("button",{onClick:()=>{0===ac.length&&_(a.college._id),ad([...ac,a._id])},className:"w-full text-left px-4 py-3 hover:bg-muted text-sm transition-colors flex justify-between items-center group",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-bold",children:a.name||"Unknown student"}),(0,b.jsxs)("p",{className:"text-[10px] text-muted-foreground truncate",children:[a.registrationCode," • ",a.college.name]})]}),(0,b.jsx)(e.Plus,{className:"h-4 w-4 text-muted-foreground group-hover:text-primary transition-colors"})]},a._id))})]}),(0,b.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,b.jsx)("button",{onClick:am,className:"flex-1 px-4 py-2 border border-border rounded-lg text-sm hover:bg-secondary transition-colors font-medium",children:"Cancel"}),(0,b.jsx)("button",{onClick:al,disabled:0===ac.length,className:"flex-1 px-4 py-2 bg-primary text-primary-foreground rounded-lg text-sm font-bold hover:bg-primary/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:Q?"Save Changes":"Register"})]})]})}),M&&Q&&(0,b.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4 font-sans text-foreground",children:(0,b.jsxs)("div",{className:"bg-card border border-border rounded-xl w-full max-w-sm p-6 shadow-2xl",children:[(0,b.jsxs)("h2",{className:"text-xl font-bold mb-2 flex items-center gap-2",children:[(0,b.jsx)(j.Trophy,{className:"h-5 w-5 text-yellow-500"}),"Submit Score"]}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground mb-6",children:["Enter marks for chest number ",(0,b.jsx)("span",{className:"font-bold text-primary",children:Q.chestNumber})]}),(0,b.jsxs)("form",{onSubmit:aq,className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("label",{className:"text-xs font-medium text-muted-foreground",children:"Marks / Points"}),(0,b.jsx)("input",{type:"number",step:"0.01",autoFocus:!0,required:!0,className:"w-full bg-secondary border border-border rounded-lg px-4 py-3 text-lg font-bold outline-none focus:border-primary text-center",placeholder:"0.00",value:S,onChange:a=>T(a.target.value)})]}),(0,b.jsxs)("div",{className:"flex gap-3 mt-8",children:[(0,b.jsx)("button",{type:"button",onClick:()=>N(!1),className:"flex-1 px-4 py-2 border border-border rounded-lg text-sm hover:bg-secondary transition-colors",children:"Cancel"}),(0,b.jsx)("button",{type:"submit",disabled:W,className:"flex-1 px-4 py-2 bg-primary text-primary-foreground rounded-lg text-sm font-bold hover:bg-primary/90 transition-colors disabled:opacity-50 flex items-center justify-center gap-2",children:W?"Submitting...":"Save Score"})]})]})]})}),O&&Q&&(0,b.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4 font-sans text-foreground",children:(0,b.jsxs)("div",{className:"bg-card border border-border rounded-xl w-full max-w-sm p-6 shadow-2xl",children:[(0,b.jsxs)("h2",{className:"text-xl font-bold mb-2 flex items-center gap-2 text-destructive",children:[(0,b.jsx)(p,{className:"h-5 w-5"}),"Cancel Registration"]}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground mb-6",children:["Reason for cancellation of ",(0,b.jsx)("span",{className:"font-bold",children:Q.chestNumber})]}),(0,b.jsxs)("form",{onSubmit:ap,className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("label",{className:"text-xs font-medium text-muted-foreground",children:"Reason"}),(0,b.jsx)("textarea",{required:!0,rows:3,className:"w-full bg-secondary border border-border rounded-lg px-3 py-2 text-sm outline-none focus:border-primary resize-none",placeholder:"e.g. Student absent, Disqualified...",value:U,onChange:a=>V(a.target.value)})]}),(0,b.jsxs)("div",{className:"flex gap-3 mt-4",children:[(0,b.jsx)("button",{type:"button",onClick:()=>P(!1),className:"flex-1 px-4 py-2 border border-border rounded-lg text-sm hover:bg-secondary transition-colors",children:"Back"}),(0,b.jsx)("button",{type:"submit",className:"flex-1 px-4 py-2 bg-destructive text-destructive-foreground rounded-lg text-sm font-bold hover:bg-destructive/90 transition-colors",children:"Confirm Cancel"})]})]})]})}),(0,b.jsxs)("div",{className:"flex items-center px-4 py-2 bg-card border border-border rounded-lg max-w-md",children:[(0,b.jsx)(f.Search,{className:"h-4 w-4 text-muted-foreground mr-2"}),(0,b.jsx)("input",{type:"text",placeholder:"Search by Chest No, Name or Reg No...",className:"bg-transparent border-none outline-none text-sm w-full",value:A,onChange:a=>B(a.target.value)})]}),(0,b.jsxs)("div",{className:"bg-card border border-border rounded-xl overflow-hidden font-sans",children:[(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"w-full text-sm text-left",children:[(0,b.jsx)("thead",{className:"bg-muted/50 text-muted-foreground uppercase text-xs font-bold",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"px-6 py-4",children:"Chest Number"}),(0,b.jsx)("th",{className:"px-6 py-4",children:"Participants"}),(0,b.jsx)("th",{className:"px-6 py-4",children:"Status"}),(0,b.jsx)("th",{className:"px-6 py-4",children:"Score"}),(0,b.jsx)("th",{className:"px-6 py-4 text-right",children:"Actions"})]})}),(0,b.jsx)("tbody",{className:"divide-y divide-border",children:y?(0,b.jsx)("tr",{children:(0,b.jsx)("td",{colSpan:5,className:"px-6 py-8 text-center text-muted-foreground",children:"Loading registrations..."})}):0===ar.length?(0,b.jsx)("tr",{children:(0,b.jsx)("td",{colSpan:5,className:"px-6 py-8 text-center text-muted-foreground font-medium",children:"No registrations found."})}):ar.map(a=>(0,b.jsxs)("tr",{className:"hover:bg-muted/30 transition-colors group",children:[(0,b.jsx)("td",{className:"px-6 py-4",children:(0,b.jsx)("span",{className:"font-mono bg-primary/10 text-primary px-3 py-1 rounded-md text-base font-black",children:a.chestNumber})}),(0,b.jsx)("td",{className:"px-6 py-4",children:(0,b.jsxs)("div",{className:"flex flex-col gap-1",children:[a.participants.map(a=>(0,b.jsxs)("div",{className:"flex flex-col gap-0.5 mb-1 last:mb-0",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(h.UserCheck,{className:"h-3 w-3 text-muted-foreground"}),(0,b.jsx)("span",{className:"font-medium text-foreground",children:a.name||"N/A"})]}),(0,b.jsxs)("div",{className:"text-[10px] text-muted-foreground ml-5 font-medium",children:[a.registrationCode," • ",a.college.name]})]},a._id)),a.participants.length>1&&(0,b.jsxs)("span",{className:"text-[10px] text-purple-400 font-bold flex items-center gap-1 mt-1 bg-purple-400/10 w-fit px-1.5 py-0.5 rounded",children:[(0,b.jsx)(i.Users,{className:"h-3 w-3"})," GROUP ENTRY"]})]})}),(0,b.jsx)("td",{className:"px-6 py-4 capitalize",children:(0,b.jsxs)("div",{className:"flex flex-col gap-1 items-start",children:[(0,b.jsx)("span",{className:`px-2.5 py-1 rounded-full text-[10px] font-black border tracking-wider uppercase ${"participated"===a.status?"bg-green-500/10 text-green-500 border-green-500/20":"confirmed"===a.status?"bg-blue-500/10 text-blue-500 border-blue-500/20":"cancelled"===a.status?"bg-red-500/10 text-red-500 border-red-500/20":"bg-muted text-muted-foreground border-border"}`,children:a.status.replace("_"," ")}),a.cancellationReason&&(0,b.jsx)("span",{className:"text-[10px] text-destructive italic max-w-[150px] truncate",title:a.cancellationReason,children:a.cancellationReason})]})}),(0,b.jsx)("td",{className:"px-6 py-4",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:`p-1.5 rounded-lg ${a.pointsObtained>0?"bg-yellow-500/10 text-yellow-500":"bg-muted text-muted-foreground"}`,children:(0,b.jsx)(k.Star,{className:`h-4 w-4 ${a.pointsObtained>0?"fill-yellow-500":""}`})}),(0,b.jsx)("span",{className:`text-lg font-black ${a.pointsObtained>0?"text-foreground":"text-muted-foreground"}`,children:a.pointsObtained||"0.00"})]})}),(0,b.jsx)("td",{className:"px-6 py-4 text-right",children:(0,b.jsxs)("div",{className:"flex items-center justify-end gap-1",children:["open"===a.status&&(0,b.jsx)("button",{title:"Confirm Registration",onClick:()=>ao(a._id,"confirmed"),className:"p-2 hover:bg-blue-500/10 rounded-lg text-muted-foreground hover:text-blue-500 transition-all",children:(0,b.jsx)(o.CheckCircle,{className:"h-4 w-4"})}),"confirmed"===a.status&&(0,b.jsx)("button",{title:"Mark as Participated",onClick:()=>ao(a._id,"participated"),className:"p-2 hover:bg-green-500/10 rounded-lg text-muted-foreground hover:text-green-500 transition-all",children:(0,b.jsx)(j.Trophy,{className:"h-4 w-4"})}),"cancelled"!==a.status&&(0,b.jsx)("button",{title:"Cancel Registration",onClick:()=>{R(a),P(!0)},className:"p-2 hover:bg-red-500/10 rounded-lg text-muted-foreground hover:text-red-500 transition-all",children:(0,b.jsx)(p,{className:"h-4 w-4"})}),(0,b.jsx)("div",{className:"h-4 w-px bg-border mx-1"}),(0,b.jsx)("button",{title:G?"Score Locked (Published)":"Submit Score",onClick:()=>{G||(R(a),T(a.pointsObtained?.toString()||""),N(!0))},className:`p-2 rounded-lg transition-all border border-transparent ${G?"text-muted-foreground/30 cursor-not-allowed":"hover:bg-yellow-500/10 text-muted-foreground hover:text-yellow-500 hover:border-yellow-500/20"}`,children:G?(0,b.jsx)(n.Lock,{className:"h-4 w-4"}):(0,b.jsx)(k.Star,{className:"h-4 w-4"})}),(0,b.jsx)("button",{title:"Edit Registration",onClick:()=>{R(a),ad(a.participants.map(a=>a._id)),L(!0)},className:"p-2 hover:bg-secondary rounded-lg text-muted-foreground hover:text-foreground transition-all",children:(0,b.jsx)(q.Edit,{className:"h-4 w-4"})}),(0,b.jsx)("button",{title:"Delete Permanently",onClick:()=>an(a._id),className:"p-2 hover:bg-destructive/10 rounded-lg text-muted-foreground hover:text-destructive transition-all border border-transparent hover:border-destructive/20",children:(0,b.jsx)(g.Trash2,{className:"h-4 w-4"})})]})})]},a._id))})]})}),C&&C.pages>1&&(0,b.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 bg-muted/20 border-t border-border",children:[(0,b.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Showing ",(E-1)*C.limit+1," to ",Math.min(E*C.limit,C.total)," of ",C.total," results"]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("button",{onClick:()=>F(a=>Math.max(1,a-1)),disabled:1===E,className:"p-1 rounded hover:bg-muted disabled:opacity-50 transition-colors",children:(0,b.jsx)(l.ChevronLeft,{className:"h-4 w-4"})}),(0,b.jsxs)("span",{className:"text-xs font-medium",children:["Page ",E," of ",C.pages]}),(0,b.jsx)("button",{onClick:()=>F(a=>Math.min(C.pages,a+1)),disabled:E===C.pages,className:"p-1 rounded hover:bg-muted disabled:opacity-50 transition-colors",children:(0,b.jsx)(m.ChevronRight,{className:"h-4 w-4"})})]})]})]})]})}a.s(["default",()=>v],23728)}];

//# sourceMappingURL=d9ade_dashboard_events_%5Bid%5D_programs_%5BprogramId%5D_registrations_page_tsx_c21df5ae._.js.map