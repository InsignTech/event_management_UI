(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,55436,e=>{"use strict";let s=(0,e.i(75254).default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);e.s(["Search",()=>s],55436)},44075,e=>{"use strict";var s=e.i(5766);e.s(["showError",0,e=>{let t,r=(t=e.response?.data,t?.errors&&Array.isArray(t.errors)&&t.errors.length>0?t.errors.map(e=>e.message||e).join(", "):t?.message?t.message:e.message||"An unexpected error occurred");s.toast.error(r,{style:{borderRadius:"10px",background:"#333",color:"#fff"}})},"showSuccess",0,e=>{s.toast.success(e,{style:{borderRadius:"10px",background:"#333",color:"#fff"}})}])},70756,e=>{"use strict";let s=(0,e.i(75254).default)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);e.s(["Lock",()=>s],70756)},63059,e=>{"use strict";let s=(0,e.i(75254).default)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);e.s(["ChevronRight",()=>s],63059)},70273,73375,69638,e=>{"use strict";var s=e.i(75254);let t=(0,s.default)("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);e.s(["Star",()=>t],70273);let r=(0,s.default)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);e.s(["ChevronLeft",()=>r],73375);let a=(0,s.default)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);e.s(["CheckCircle",()=>a],69638)},98493,e=>{"use strict";var s=e.i(43476),t=e.i(71645),r=e.i(64030),a=e.i(55436),l=e.i(70273),o=e.i(75254);let n=(0,o.default)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]);var d=e.i(73375),c=e.i(63059);let i=(0,o.default)("share",[["path",{d:"M12 2v13",key:"1km8f5"}],["path",{d:"m16 6-4-4-4 4",key:"13yo43"}],["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}]]);var u=e.i(69638),m=e.i(70756),x=e.i(54858),h=e.i(44075);function p(){let[e,o]=(0,t.useState)([]),[p,f]=(0,t.useState)([]),[b,g]=(0,t.useState)(!1),[y,j]=(0,t.useState)(!0),[N,v]=(0,t.useState)(""),[w,k]=(0,t.useState)("none"),[S,C]=(0,t.useState)(null),[P,R]=(0,t.useState)(1),[M,A]=(0,t.useState)(""),L=(0,t.useMemo)(()=>p.find(e=>e._id===w),[p,w]);(0,t.useEffect)(()=>{let e=setTimeout(()=>{A(N)},500);return()=>clearTimeout(e)},[N]),(0,t.useEffect)(()=>{T()},[]),(0,t.useEffect)(()=>{"none"!==w?E(P,M):(o([]),C(null))},[w,P,M]);let T=async()=>{try{j(!0);let e=await x.default.get("/programs");e.data.success&&f(e.data.data)}catch(e){console.error("Failed to fetch programs",e)}finally{j(!1)}},E=async(e,s="")=>{try{g(!0);let t=await x.default.get(`/registrations/program/${w}?page=${e}&limit=20&search=${s}`);t.data.success&&(o(t.data.registrations),C(t.data.pagination))}catch(e){console.error("Failed to fetch registrations",e)}finally{g(!1)}},z=async()=>{if("none"!==w&&confirm("Are you sure you want to publish the results? This will finalize the scores and make them public. This action cannot be undone."))try{(await x.default.post(`/programs/${w}/publish`)).data.success&&((0,h.showSuccess)("Results published successfully"),T())}catch(e){(0,h.showError)(e)}},[U,$]=(0,t.useState)(!1),[_,F]=(0,t.useState)(null),[O,q]=(0,t.useState)(""),[B,I]=(0,t.useState)(!1),K=async e=>{if(e.preventDefault(),_&&O&&w){I(!0);try{(await x.default.post("/scores/submit",{programId:w,registrationId:_._id,criteria:{Mark:parseFloat(O)}})).data.success&&((0,h.showSuccess)("Score submitted successfully"),$(!1),q(""),F(null),E(P,M))}catch(e){(0,h.showError)(e)}finally{I(!1)}}},D=L?.isResultPublished||!1;return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold",children:"Scoring & Results"}),"none"!==w&&(0,s.jsx)("div",{className:"flex items-center gap-2",children:D?(0,s.jsxs)("span",{className:"flex items-center gap-2 px-3 py-1.5 bg-green-500/10 text-green-500 rounded-full text-sm font-semibold border border-green-500/20",children:[(0,s.jsx)(u.CheckCircle,{className:"h-4 w-4"}),"Results Published"]}):(0,s.jsxs)("button",{onClick:z,className:"flex items-center gap-2 px-4 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors font-medium text-sm",children:[(0,s.jsx)(i,{className:"h-4 w-4"}),"Publish Results"]})})]}),U&&_&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4 font-sans text-foreground transition-all backdrop-blur-sm",children:(0,s.jsxs)("div",{className:"bg-card border border-border rounded-xl w-full max-w-sm p-6 shadow-2xl animate-in fade-in zoom-in duration-200",children:[(0,s.jsxs)("h2",{className:"text-xl font-bold mb-2 flex items-center gap-2",children:[(0,s.jsx)(r.Trophy,{className:"h-5 w-5 text-yellow-500"}),"Edit Score"]}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground mb-6",children:["Update marks for chest number ",(0,s.jsx)("span",{className:"font-bold text-primary",children:_.chestNumber})]}),(0,s.jsxs)("form",{onSubmit:K,className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("label",{className:"text-xs font-medium text-muted-foreground",children:"Marks / Points"}),(0,s.jsx)("input",{type:"number",step:"0.01",autoFocus:!0,required:!0,className:"w-full bg-secondary border border-border rounded-lg px-4 py-3 text-lg font-bold outline-none focus:border-primary text-center",placeholder:"0.00",value:O,onChange:e=>q(e.target.value)})]}),(0,s.jsxs)("div",{className:"flex gap-3 mt-8",children:[(0,s.jsx)("button",{type:"button",onClick:()=>$(!1),className:"flex-1 px-4 py-2 border border-border rounded-lg text-sm hover:bg-secondary transition-colors",children:"Cancel"}),(0,s.jsx)("button",{type:"submit",disabled:B,className:"flex-1 px-4 py-2 bg-primary text-primary-foreground rounded-lg text-sm font-bold hover:bg-primary/90 transition-colors disabled:opacity-50 flex items-center justify-center gap-2",children:B?"Updating...":"Update Score"})]})]})]})}),(0,s.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 items-start md:items-center",children:[(0,s.jsxs)("div",{className:"flex items-center px-4 py-2 bg-card border border-border rounded-lg w-full max-w-md",children:[(0,s.jsx)(a.Search,{className:"h-4 w-4 text-muted-foreground mr-2"}),(0,s.jsx)("input",{type:"text",placeholder:"Search by Chest No or Reg No...",className:"bg-transparent border-none outline-none text-sm w-full",value:N,onChange:e=>{v(e.target.value),R(1)},disabled:"none"===w})]}),(0,s.jsxs)("div",{className:"flex items-center px-3 py-2 bg-card border border-border rounded-lg w-full md:w-64",children:[(0,s.jsx)(n,{className:"h-4 w-4 text-muted-foreground mr-2"}),(0,s.jsxs)("select",{className:"bg-transparent border-none outline-none text-sm w-full cursor-pointer text-foreground appearance-none focus:ring-0",value:w,onChange:e=>{k(e.target.value),R(1),v("")},disabled:y,children:[(0,s.jsx)("option",{value:"none",className:"bg-card text-foreground",children:"Select a Program"}),p.map(e=>(0,s.jsxs)("option",{value:e._id,className:"bg-card text-foreground",children:[e.name," ",e.isResultPublished?"(Published)":""]},e._id))]})]})]}),(0,s.jsxs)("div",{className:"bg-card border border-border rounded-xl overflow-hidden",children:[(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full text-sm text-left",children:[(0,s.jsx)("thead",{className:"bg-muted/50 text-muted-foreground uppercase text-xs",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-6 py-3",children:"Chest No"}),(0,s.jsx)("th",{className:"px-6 py-3",children:"Program"}),(0,s.jsx)("th",{className:"px-6 py-3",children:"Participants"}),(0,s.jsx)("th",{className:"px-6 py-3",children:"Rank"}),(0,s.jsx)("th",{className:"px-6 py-3",children:"Points"}),(0,s.jsx)("th",{className:"px-6 py-3 text-right",children:"Actions"})]})}),(0,s.jsx)("tbody",{className:"divide-y divide-border",children:y||b?(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:6,className:"px-6 py-8 text-center text-muted-foreground",children:"Loading..."})}):"none"===w?(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:6,className:"px-6 py-8 text-center text-muted-foreground",children:"Please select a program to view results."})}):0===e.length?(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:6,className:"px-6 py-8 text-center text-muted-foreground",children:"No results found for this program."})}):e.map(e=>(0,s.jsxs)("tr",{className:"hover:bg-muted/30 transition-colors",children:[(0,s.jsx)("td",{className:"px-6 py-4 font-mono font-bold",children:e.chestNumber}),(0,s.jsxs)("td",{className:"px-6 py-4",children:[(0,s.jsx)("p",{className:"font-bold",children:e.program.name}),(0,s.jsx)("p",{className:"text-[10px] text-muted-foreground uppercase",children:e.program.type})]}),(0,s.jsx)("td",{className:"px-6 py-4",children:(0,s.jsx)("div",{className:"flex flex-col gap-0.5",children:e.participants.map((e,t)=>(0,s.jsx)("span",{className:"text-xs",children:e.registrationCode},t))})}),(0,s.jsx)("td",{className:"px-6 py-4",children:e.rank?(0,s.jsxs)("span",{className:`flex items-center gap-1 font-bold ${1===e.rank?"text-yellow-500":2===e.rank?"text-slate-400":3===e.rank?"text-amber-700":""}`,children:[(0,s.jsx)(l.Star,{className:"h-3 w-3 fill-current"}),e.rank]}):"-"}),(0,s.jsx)("td",{className:"px-6 py-4 font-bold",children:e.pointsObtained||0}),(0,s.jsx)("td",{className:"px-6 py-4 text-right",children:D?(0,s.jsxs)("button",{disabled:!0,className:"text-muted-foreground/50 cursor-not-allowed flex items-center gap-1 text-xs font-bold ml-auto",children:[(0,s.jsx)(m.Lock,{className:"h-3 w-3"}),"Locked"]}):(0,s.jsx)("button",{onClick:()=>{F(e),q(e.pointsObtained?.toString()||""),$(!0)},className:"text-primary hover:underline text-xs font-bold",children:"Edit Score"})})]},e._id))})]})}),S&&S.pages>1&&(0,s.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 bg-muted/20 border-t border-border",children:[(0,s.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Showing ",(P-1)*S.limit+1," to ",Math.min(P*S.limit,S.total)," of ",S.total," results"]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("button",{onClick:()=>R(e=>Math.max(1,e-1)),disabled:1===P,className:"p-1 rounded hover:bg-muted disabled:opacity-50",children:(0,s.jsx)(d.ChevronLeft,{className:"h-4 w-4"})}),(0,s.jsxs)("span",{className:"text-xs font-medium",children:["Page ",P," of ",S.pages]}),(0,s.jsx)("button",{onClick:()=>R(e=>Math.min(S.pages,e+1)),disabled:P===S.pages,className:"p-1 rounded hover:bg-muted disabled:opacity-50",children:(0,s.jsx)(c.ChevronRight,{className:"h-4 w-4"})})]})]})]})]})}e.s(["default",()=>p],98493)}]);