{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/PROJECT/MES/client/lib/api.ts"],"sourcesContent":["import axios from 'axios';\r\n\r\nconst api = axios.create({\r\n    baseURL: process.env.NEXT_PUBLIC_API_URL || 'http://localhost:5000/api',\r\n    headers: {\r\n        'Content-Type': 'application/json',\r\n    },\r\n});\r\n\r\n// Add interceptor to include token\r\napi.interceptors.request.use((config) => {\r\n    if (typeof window !== 'undefined') {\r\n        const token = localStorage.getItem('token');\r\n        if (token) {\r\n            config.headers.Authorization = `Bearer ${token}`;\r\n        }\r\n    }\r\n    return config;\r\n});\r\n\r\nexport default api;\r\n"],"names":[],"mappings":";;;;AAGa;AAHb;;AAEA,MAAM,MAAM,mJAAK,CAAC,MAAM,CAAC;IACrB,SAAS,2KAAO,CAAC,GAAG,CAAC,mBAAmB,IAAI;IAC5C,SAAS;QACL,gBAAgB;IACpB;AACJ;AAEA,mCAAmC;AACnC,IAAI,YAAY,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;IAC1B,wCAAmC;QAC/B,MAAM,QAAQ,aAAa,OAAO,CAAC;QACnC,IAAI,OAAO;YACP,OAAO,OAAO,CAAC,aAAa,GAAG,CAAC,OAAO,EAAE,OAAO;QACpD;IACJ;IACA,OAAO;AACX;uCAEe"}},
    {"offset": {"line": 35, "column": 0}, "map": {"version":3,"sources":["file:///D:/PROJECT/MES/client/app/%28admin%29/dashboard/scoring/page.tsx"],"sourcesContent":["\"use client\";\r\nimport React, { useEffect, useState, useMemo } from 'react';\r\nimport { Trophy, Search, Star, UserCheck, Filter, ChevronLeft, ChevronRight } from 'lucide-react';\r\nimport api from '@/lib/api';\r\n\r\ninterface Registration {\r\n    _id: string;\r\n    chestNumber: string;\r\n    participants: { universityRegNo: string }[];\r\n    program: { _id: string, name: string, type: string };\r\n    pointsObtained: number;\r\n    rank: number;\r\n}\r\n\r\ninterface Program {\r\n    _id: string;\r\n    name: string;\r\n}\r\n\r\ninterface PaginationMeta {\r\n    total: number;\r\n    page: number;\r\n    limit: number;\r\n    pages: number;\r\n}\r\n\r\nexport default function ScoringPage() {\r\n    const [registrations, setRegistrations] = useState<Registration[]>([]);\r\n    const [programs, setPrograms] = useState<Program[]>([]);\r\n    const [loading, setLoading] = useState(false);\r\n    const [progLoading, setProgLoading] = useState(true);\r\n    const [searchTerm, setSearchTerm] = useState('');\r\n    const [selectedProgram, setSelectedProgram] = useState<string>('none');\r\n    const [pagination, setPagination] = useState<PaginationMeta | null>(null);\r\n    const [page, setPage] = useState(1);\r\n    const [debouncedSearch, setDebouncedSearch] = useState('');\r\n\r\n    useEffect(() => {\r\n        const timer = setTimeout(() => {\r\n            setDebouncedSearch(searchTerm);\r\n        }, 500);\r\n        return () => clearTimeout(timer);\r\n    }, [searchTerm]);\r\n\r\n    useEffect(() => {\r\n        fetchPrograms();\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        if (selectedProgram !== 'none') {\r\n            fetchRegistrations(page, debouncedSearch);\r\n        } else {\r\n            setRegistrations([]);\r\n            setPagination(null);\r\n        }\r\n    }, [selectedProgram, page, debouncedSearch]);\r\n\r\n    const fetchPrograms = async () => {\r\n        try {\r\n            setProgLoading(true);\r\n            const res = await api.get('/programs');\r\n            if (res.data.success) {\r\n                setPrograms(res.data.data);\r\n            }\r\n        } catch (error) {\r\n            console.error('Failed to fetch programs', error);\r\n        } finally {\r\n            setProgLoading(false);\r\n        }\r\n    };\r\n\r\n    const fetchRegistrations = async (pageNum: number, searchStr: string = '') => {\r\n        try {\r\n            setLoading(true);\r\n            const res = await api.get(`/registrations/program/${selectedProgram}?page=${pageNum}&limit=20&search=${searchStr}`);\r\n            if (res.data.success) {\r\n                setRegistrations(res.data.registrations);\r\n                setPagination(res.data.pagination);\r\n            }\r\n        } catch (error) {\r\n            console.error('Failed to fetch registrations', error);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const handleProgramChange = (e: React.ChangeEvent<HTMLSelectElement>) => {\r\n        setSelectedProgram(e.target.value);\r\n        setPage(1);\r\n        setSearchTerm(''); // Optional: clear search on program change\r\n    };\r\n\r\n    const handleSearchChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        setSearchTerm(e.target.value);\r\n        setPage(1); // Reset to page 1 on search\r\n    };\r\n\r\n    return (\r\n        <div className=\"space-y-6\">\r\n            <h1 className=\"text-3xl font-bold\">Scoring & Results</h1>\r\n            \r\n            <div className=\"flex flex-col md:flex-row gap-4 items-start md:items-center\">\r\n                <div className=\"flex items-center px-4 py-2 bg-card border border-border rounded-lg w-full max-w-md\">\r\n                    <Search className=\"h-4 w-4 text-muted-foreground mr-2\" />\r\n                    <input \r\n                        type=\"text\" \r\n                        placeholder=\"Search by Chest No or Reg No...\" \r\n                        className=\"bg-transparent border-none outline-none text-sm w-full\"\r\n                        value={searchTerm}\r\n                        onChange={handleSearchChange}\r\n                        disabled={selectedProgram === 'none'}\r\n                    />\r\n                </div>\r\n\r\n                <div className=\"flex items-center px-3 py-2 bg-card border border-border rounded-lg w-full md:w-64\">\r\n                    <Filter className=\"h-4 w-4 text-muted-foreground mr-2\" />\r\n                    <select \r\n                        className=\"bg-transparent border-none outline-none text-sm w-full cursor-pointer text-foreground appearance-none focus:ring-0\"\r\n                        value={selectedProgram}\r\n                        onChange={handleProgramChange}\r\n                        disabled={progLoading}\r\n                    >\r\n                        <option value=\"none\" className=\"bg-card text-foreground\">Select a Program</option>\r\n                        {programs.map(prog => (\r\n                            <option key={prog._id} value={prog._id} className=\"bg-card text-foreground\">\r\n                                {prog.name}\r\n                            </option>\r\n                        ))}\r\n                    </select>\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"bg-card border border-border rounded-xl overflow-hidden\">\r\n                <div className=\"overflow-x-auto\">\r\n                    <table className=\"w-full text-sm text-left\">\r\n                        <thead className=\"bg-muted/50 text-muted-foreground uppercase text-xs\">\r\n                            <tr>\r\n                                <th className=\"px-6 py-3\">Chest No</th>\r\n                                <th className=\"px-6 py-3\">Program</th>\r\n                                <th className=\"px-6 py-3\">Participants</th>\r\n                                <th className=\"px-6 py-3\">Rank</th>\r\n                                <th className=\"px-6 py-3\">Points</th>\r\n                                <th className=\"px-6 py-3 text-right\">Actions</th>\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody className=\"divide-y divide-border\">\r\n                            {progLoading || loading ? (\r\n                                <tr><td colSpan={6} className=\"px-6 py-8 text-center text-muted-foreground\">Loading...</td></tr>\r\n                            ) : selectedProgram === 'none' ? (\r\n                                <tr><td colSpan={6} className=\"px-6 py-8 text-center text-muted-foreground\">Please select a program to view results.</td></tr>\r\n                            ) : registrations.length === 0 ? (\r\n                                <tr><td colSpan={6} className=\"px-6 py-8 text-center text-muted-foreground\">No results found for this program.</td></tr>\r\n                            ) : (\r\n                                registrations.map((reg) => (\r\n                                    <tr key={reg._id} className=\"hover:bg-muted/30 transition-colors\">\r\n                                        <td className=\"px-6 py-4 font-mono font-bold\">{reg.chestNumber}</td>\r\n                                        <td className=\"px-6 py-4\">\r\n                                            <p className=\"font-bold\">{reg.program.name}</p>\r\n                                            <p className=\"text-[10px] text-muted-foreground uppercase\">{reg.program.type}</p>\r\n                                        </td>\r\n                                        <td className=\"px-6 py-4\">\r\n                                            <div className=\"flex flex-col gap-0.5\">\r\n                                                {reg.participants.map((p, i) => (\r\n                                                    <span key={i} className=\"text-xs\">{p.universityRegNo}</span>\r\n                                                ))}\r\n                                            </div>\r\n                                        </td>\r\n                                        <td className=\"px-6 py-4\">\r\n                                            {reg.rank ? (\r\n                                                <span className={`flex items-center gap-1 font-bold ${\r\n                                                    reg.rank === 1 ? 'text-yellow-500' : \r\n                                                    reg.rank === 2 ? 'text-slate-400' : \r\n                                                    reg.rank === 3 ? 'text-amber-700' : ''\r\n                                                }`}>\r\n                                                    <Star className=\"h-3 w-3 fill-current\" />\r\n                                                    {reg.rank}\r\n                                                </span>\r\n                                            ) : '-'}\r\n                                        </td>\r\n                                        <td className=\"px-6 py-4 font-bold\">{reg.pointsObtained || 0}</td>\r\n                                        <td className=\"px-6 py-4 text-right\">\r\n                                            <button className=\"text-primary hover:underline text-xs font-bold\">Edit Score</button>\r\n                                        </td>\r\n                                    </tr>\r\n                                ))\r\n                            )}\r\n                        </tbody>\r\n                    </table>\r\n                </div>\r\n\r\n                {pagination && pagination.pages > 1 && (\r\n                    <div className=\"flex items-center justify-between px-6 py-4 bg-muted/20 border-t border-border\">\r\n                        <div className=\"text-xs text-muted-foreground\">\r\n                            Showing {((page - 1) * pagination.limit) + 1} to {Math.min(page * pagination.limit, pagination.total)} of {pagination.total} results\r\n                        </div>\r\n                        <div className=\"flex items-center gap-2\">\r\n                            <button \r\n                                onClick={() => setPage(p => Math.max(1, p - 1))}\r\n                                disabled={page === 1}\r\n                                className=\"p-1 rounded hover:bg-muted disabled:opacity-50\"\r\n                            >\r\n                                <ChevronLeft className=\"h-4 w-4\" />\r\n                            </button>\r\n                            <span className=\"text-xs font-medium\">Page {page} of {pagination.pages}</span>\r\n                            <button \r\n                                onClick={() => setPage(p => Math.min(pagination.pages, p + 1))}\r\n                                disabled={page === pagination.pages}\r\n                                className=\"p-1 rounded hover:bg-muted disabled:opacity-50\"\r\n                            >\r\n                                <ChevronRight className=\"h-4 w-4\" />\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":"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"}}]
}